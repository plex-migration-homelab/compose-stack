# Web Services - Overseerr and Wizarr
# These services are accessed via VPS reverse proxy (WireGuard tunnel)

services:
  nginxproxymanager:
    image: jc21/nginx-proxy-manager:latest
    container_name: nginxproxymanager
    restart: unless-stopped
    environment:
      - TZ=${TZ:-America/New_York}
    ports:
      - "1880:80"     # HTTP
      - "18443:443"   # HTTPS
      - "81:81"     # Admin Web Interface
    volumes:
      - ${APPDATA_PATH}/nginxproxymanager/data:/data:z
      - ${APPDATA_PATH}/nginxproxymanager/letsencrypt:/etc/letsencrypt:z
    networks:
      - web
    labels:
      - "com.centurylinklabs.watchtower.enable=true"

  overseerr:
    image: lscr.io/linuxserver/overseerr:latest
    container_name: overseerr
    restart: unless-stopped
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-America/New_York}
    ports:
      - "5055:5055"
    volumes:
      - ${APPDATA_PATH}/overseerr:/config:z
    networks:
      - web
    labels:
      - "com.centurylinklabs.watchtower.enable=true"

  wizarr:
    image: ghcr.io/wizarrrr/wizarr:latest
    container_name: wizarr
    restart: unless-stopped
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - TZ=${TZ:-America/New_York}
    ports:
      - "5690:5690"
    volumes:
      - ${APPDATA_PATH}/wizarr:/data/database:z
    networks:
      - web
    labels:
      - "com.centurylinklabs.watchtower.enable=true"

  cloudflareddns:
    image: ghcr.io/hotio/cloudflareddns:latest
    container_name: cloudflareddns
    restart: always
    environment:
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
      - UMASK=002
      - TZ=${TZ:-America/Chicago}
      - INTERVAL=300
      - DETECTION_MODE=dig-whoami.cloudflare
      - LOG_LEVEL=3
      - CF_USER=${CF_USER:-justincaveda11031@gmail.com}
      - CF_APITOKEN=${CF_APITOKEN}
      - CF_APIKEY=${CF_APIKEY:-}
      - CF_APITOKEN_ZONE=${CF_APITOKEN_ZONE:-}
      - CF_ZONES=nyquil-babies.com
      - CF_HOSTS=dns.nyquil-babies.com;plex.nyquil-babies.com;jellyfin.nyquil-babies.com;watch.nyquil-babies.com
      - CF_RECORDTYPES=A
      - VPN_ENABLED=false
      - PRIVOXY_ENABLED=false
      - UNBOUND_ENABLED=false
    networks:
      - web
    labels:
      - "com.centurylinklabs.watchtower.enable=true"

networks:
  web:
    name: web
    driver: bridge
